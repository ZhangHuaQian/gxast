(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24b77e34"],{4474:function(e,a,t){"use strict";var s=t("933b"),o=t.n(s);o.a},6869:function(e,a,t){"use strict";var s=t("1988"),o=t("a142");function i(e){return e=e.replace(/[^-|\d]/g,""),/^((\+86)|(86))?(1)\d{10}$/.test(e)||/^0[0-9-]{10,13}$/.test(e)}var n=t("1125"),r=t("565f"),l=t("e41f"),d=t("d399"),c=t("b650"),u=t("2241"),h=t("7744"),f=Object(o["k"])("address-edit-detail"),p=f[0],m=f[1],v=f[2],b=Object(o["c"])(),g=p({props:{value:String,error:Boolean,focused:Boolean,detailRows:Number,searchResult:Array,showSearchResult:Boolean},methods:{onSelect:function(e){this.$emit("select-search",e),this.$emit("input",((e.address||"")+" "+(e.name||"")).trim())},onFinish:function(){this.$refs.field.blur()},renderFinish:function(){var e=this.$createElement,a=this.value&&this.focused&&b;if(a)return e("div",{class:m("finish"),on:{click:this.onFinish}},[v("complete")])},renderSearchResult:function(){var e=this,a=this.$createElement,t=this.searchResult,s=this.focused&&t&&this.showSearchResult;if(s)return t.map(function(t){return a(h["a"],{key:t.name+t.address,attrs:{title:t.name,label:t.address,icon:"location-o",clickable:!0},on:{click:function(){e.onSelect(t)}}})})}},render:function(e){return e(h["a"],{class:m()},[e(r["a"],{attrs:{autosize:!0,rows:this.detailRows,clearable:!b,type:"textarea",maxlength:"200",value:this.value,error:this.error,label:v("label"),placeholder:v("placeholder")},ref:"field",scopedSlots:{icon:this.renderFinish},on:Object(s["a"])({},this.$listeners)}),this.renderSearchResult()])}}),w=t("861b"),y=t.n(w),D=t("ba31"),C=t("543e"),k={value:null,loading:Boolean,disabled:Boolean,activeColor:String,inactiveColor:String,activeValue:{type:null,default:!0},inactiveValue:{type:null,default:!1},size:{type:String,default:"30px"}},j=Object(o["k"])("switch"),I=j[0],$=j[1];function S(e,a,t,s){var o=a.value,i=a.loading,n=a.disabled,r=a.activeValue,l=a.inactiveValue,d=o===r,c={fontSize:a.size,backgroundColor:d?a.activeColor:a.inactiveColor},u=function(){if(!n&&!i){var e=d?l:r;Object(D["a"])(s,"input",e),Object(D["a"])(s,"change",e)}};return e("div",y()([{class:$({on:d,disabled:n}),style:c,on:{click:u}},Object(D["b"])(s)]),[e("div",{class:$("node")},[i&&e(C["a"],{class:$("loading")})])])}S.props=k;var O=I(S),x=Object(o["k"])("switch-cell"),A=x[0],R=x[1];function B(e,a,t,o){return e(h["a"],y()([{attrs:{center:!0,title:a.title,border:a.border},class:R()},Object(D["b"])(o)]),[e(O,{props:Object(s["a"])({},a),on:Object(s["a"])({},o.listeners)})])}B.props=Object(s["a"])({},k,{title:String,border:Boolean,size:{type:String,default:"24px"}});var _=A(B),L=Object(o["k"])("address-edit"),F=L[0],z=L[1],P=L[2],V={name:"",tel:"",country:"",province:"",city:"",county:"",areaCode:"",postalCode:"",addressDetail:"",isDefault:!1};a["a"]=F({props:{areaList:Object,isSaving:Boolean,isDeleting:Boolean,validator:Function,showDelete:Boolean,showPostal:Boolean,searchResult:Array,showSetDefault:Boolean,showSearchResult:Boolean,saveButtonText:String,deleteButtonText:String,showArea:{type:Boolean,default:!0},showDetail:{type:Boolean,default:!0},detailRows:{type:Number,default:1},addressInfo:{type:Object,default:function(){return Object(s["a"])({},V)}},telValidator:{type:Function,default:i}},data:function(){return{data:{},showAreaPopup:!1,detailFocused:!1,errorInfo:{tel:!1,name:!1,postalCode:!1,addressDetail:!1}}},computed:{areaListLoaded:function(){return Object(o["g"])(this.areaList)&&Object.keys(this.areaList).length},areaText:function(){var e=this.data,a=e.country,t=e.province,s=e.city,o=e.county,i=e.areaCode;if(i){var n=[a,t,s,o];return t&&t===s&&n.splice(1,1),n.filter(function(e){return e}).join("/")}return""}},watch:{addressInfo:{handler:function(e){this.data=Object(s["a"])({},V,e),this.setAreaCode(e.areaCode)},deep:!0,immediate:!0},areaList:function(){this.setAreaCode(this.data.areaCode)}},methods:{onFocus:function(e){this.errorInfo[e]=!1,this.detailFocused="addressDetail"===e,this.$emit("focus",e)},onChangeDetail:function(e){this.data.addressDetail=e,this.$emit("change-detail",e)},onAreaConfirm:function(e){this.showAreaPopup=!1,this.assignAreaValues(),this.$emit("change-area",e)},assignAreaValues:function(){var e=this.$refs.area;if(e){var a=e.getArea();a.areaCode=a.code,delete a.code,Object(s["a"])(this.data,a)}},onSave:function(){var e=this,a=["name","tel","areaCode","addressDetail"];this.showPostal&&a.push("postalCode");var t=a.every(function(a){var t=e.getErrorMessage(a);return t&&(e.errorInfo[a]=!0,Object(d["a"])(t)),!t});t&&!this.isSaving&&this.$emit("save",this.data)},getErrorMessage:function(e){var a=String(this.data[e]||"").trim();if(this.validator){var t=this.validator(e,a);if(t)return t}switch(e){case"name":return a?"":P("nameEmpty");case"tel":return this.telValidator(a)?"":P("telInvalid");case"areaCode":return a?"":P("areaEmpty");case"addressDetail":return a?"":P("addressEmpty");case"postalCode":return a&&!/^\d{6}$/.test(a)?P("postalEmpty"):""}},onDelete:function(){var e=this;u["a"].confirm({title:P("confirmDelete")}).then(function(){e.$emit("delete",e.data)})["catch"](function(){e.$emit("cancel-delete",e.data)})},getArea:function(){return this.$refs.area?this.$refs.area.getValues():[]},setAreaCode:function(e){this.data.areaCode=e||"",e&&this.$nextTick(this.assignAreaValues)},setAddressDetail:function(e){this.data.addressDetail=e},onDetailBlur:function(){var e=this;setTimeout(function(){e.detailFocused=!1})}},render:function(e){var a=this,t=this.data,s=this.errorInfo,o=function(e){return function(){return a.onFocus(e)}},i=this.searchResult.length&&this.detailFocused;return e("div",{class:z()},[e(r["a"],{attrs:{clearable:!0,label:P("name"),placeholder:P("namePlaceholder"),error:s.name},on:{focus:o("name")},model:{value:t.name,callback:function(e){t.name=e}}}),e(r["a"],{attrs:{clearable:!0,type:"tel",label:P("tel"),placeholder:P("telPlaceholder"),error:s.tel},on:{focus:o("tel")},model:{value:t.tel,callback:function(e){t.tel=e}}}),e(r["a"],{directives:[{name:"show",value:this.showArea}],attrs:{readonly:!0,label:P("area"),placeholder:P("areaPlaceholder"),value:this.areaText},on:{click:function(){a.showAreaPopup=!0}}}),e(g,{directives:[{name:"show",value:this.showDetail}],attrs:{focused:this.detailFocused,value:t.addressDetail,error:s.addressDetail,detailRows:this.detailRows,searchResult:this.searchResult,showSearchResult:this.showSearchResult},on:{focus:o("addressDetail"),blur:this.onDetailBlur,input:this.onChangeDetail,"select-search":function(e){a.$emit("select-search",e)}}}),this.showPostal&&e(r["a"],{directives:[{name:"show",value:!i}],attrs:{type:"tel",maxlength:"6",label:P("postal"),placeholder:P("postal"),error:s.postalCode},on:{focus:o("postalCode")},model:{value:t.postalCode,callback:function(e){t.postalCode=e}}}),this.slots(),this.showSetDefault&&e(_,{directives:[{name:"show",value:!i}],attrs:{title:P("defaultAddress")},on:{change:function(e){a.$emit("change-default",e)}},model:{value:t.isDefault,callback:function(e){t.isDefault=e}}}),e("div",{directives:[{name:"show",value:!i}],class:z("buttons")},[e(c["a"],{attrs:{block:!0,loading:this.isSaving,type:"danger",text:this.saveButtonText||P("save")},on:{click:this.onSave}}),this.showDelete&&e(c["a"],{attrs:{block:!0,loading:this.isDeleting,text:this.deleteButtonText||P("delete")},on:{click:this.onDelete}})]),e(l["a"],{attrs:{position:"bottom",lazyRender:!1,getContainer:"body"},model:{value:a.showAreaPopup,callback:function(e){a.showAreaPopup=e}}},[e(n["a"],{ref:"area",attrs:{loading:!this.areaListLoaded,value:t.areaCode,areaList:this.areaList},on:{confirm:this.onAreaConfirm,cancel:function(){a.showAreaPopup=!1}}})])])}})},"869a":function(e,a,t){"use strict";t("68ef"),t("a526"),t("1146"),t("4d75"),t("b258"),t("2fcb"),t("d9d2"),t("afaa"),t("b7e7")},"933b":function(e,a,t){},"9e1f":function(e,a,t){"use strict";t.r(a);var s,o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"add"}},[t("van-address-edit",{attrs:{"area-list":e.areaList,"address-info":e.addressInfo,"show-postal":"","show-delete":"","show-set-default":"","show-search-result":""},on:{save:e.onSave,delete:e.onDelete}})],1)},i=[],n=t("bd86"),r=(t("e7e5"),t("d399")),l=(t("869a"),t("6869")),d=(t("66b9"),t("b650")),c=(t("0653"),t("34e9")),u=(t("c194"),t("7744")),h=(t("be7f"),t("565f")),f=t("bc3a"),p=t.n(f),m=t("b1ef"),v=t("1aa8"),b={components:(s={},Object(n["a"])(s,h["a"].name,h["a"]),Object(n["a"])(s,u["a"].name,u["a"]),Object(n["a"])(s,c["a"].name,c["a"]),Object(n["a"])(s,d["a"].name,d["a"]),Object(n["a"])(s,l["a"].name,l["a"]),Object(n["a"])(s,r["a"].name,r["a"]),s),created:function(){this.ajax()},data:function(){return{areaList:v["a"],del:!1,addressInfo:{id:"",name:"",tel:"",province:"",city:"",county:"",addressDetail:"",areaCode:"",postalCode:"",isDefault:!1}}},methods:{update:function(){var e=this;p()({method:"post",url:m["a"].baseURL+"appsite/address_update",params:{id:this.$route.query.id,name:this.addressInfo.name,phone:this.addressInfo.tel,province:this.addressInfo.province,city:this.addressInfo.city,area:this.addressInfo.county,detailaddress:this.addressInfo.addressDetail,state:this.addressInfo.isDefault?1:0,mailNum:this.addressInfo.postalCode,regioncode:this.addressInfo.areaCode,cen_xczhapp_token:this.$cookies.get("cen_xczhapp_token")}}).then(function(a){1==a.data.status?(r["a"].success(a.data.msg),e.$router.push({path:"/address_list"})):r["a"].fail(a.data.msg)}).catch(function(e){r["a"].clear(),r["a"].fail("请求失败")})},ajax:function(){var e=this;r["a"].loading({mask:!0,message:"加载中...",duration:0}),p()({method:"post",url:m["a"].baseURL+"appsite/address_select",params:{id:this.$route.query.id,cen_xczhapp_token:this.$cookies.get("cen_xczhapp_token")}}).then(function(a){var t=a.data.address;e.addressInfo.id=t.id,e.addressInfo.name=t.name,e.addressInfo.tel=t.phone,e.addressInfo.province=t.province,e.addressInfo.city=t.city,e.addressInfo.county=t.area,e.addressInfo.addressDetail=t.detailaddress,e.addressInfo.isDefault=1==t.state,e.addressInfo.postalCode=t.mailNum,e.addressInfo.areaCode=t.regioncode,console.log(e.addressInfo),r["a"].clear()}).catch(function(e){r["a"].clear(),r["a"].fail("请求失败")})},onSave:function(e){this.addressInfo=e,this.update()},onDelete:function(){var e=this;p()({method:"post",url:m["a"].baseURL+"appsite/address_delete",params:{id:this.$route.query.id,cen_xczhapp_token:this.$cookies.get("cen_xczhapp_token")}}).then(function(a){1==a.data.status?(r["a"].success(a.data.msg),e.$router.push({path:"/address_list"})):r["a"].fail(a.data.msg)}).catch(function(e){r["a"].clear(),r["a"].fail("请求失败")})}}},g=b,w=(t("4474"),t("2877")),y=Object(w["a"])(g,o,i,!1,null,null,null);a["default"]=y.exports},afaa:function(e,a,t){},b7e7:function(e,a,t){},d9d2:function(e,a,t){}}]);